(function(){$(document).ready(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return b="todo",n=0,j=["minor","major","blocker"],g=function(){var a;return a=d(),m(a),$("#new-task").focus()},a=function(a){var b;return b={isDone:!1,name:a,priority:"minor"}},d=function(){var a;return a=localStorage.getItem(b),a=JSON.parse(a)||[{isDone:!1,name:"Add a new task above",priority:"major"},{isDone:!1,name:"Refresh and see your task is still here",priority:"minor"},{isDone:!1,name:"Click a task to complete it",priority:"minor"},{isDone:!1,name:"Follow <a href='http://twitter.com/humphreybc' target='_blank'>@humphreybc</a> on Twitter",priority:"minor"}]},l=function(){var b,c,e;return c=$("#new-task").val(),""!==c?(e=a(c),b=d(),b.push(e),k(b)):void 0},q=function(a,b,c){var f,g,h;return g=e(a),f=d(),h=f[g],h[b]=c,k(f)},k=function(a){return localStorage.setItem(b,JSON.stringify(a)),m(a),$("#new-task").val("")},e=function(a){var b;return b=$(a).find("input").attr("id").replace("task",""),parseInt(b)},i=function(a){var b,c;return b=d(),c=b[a],c.position=a,localStorage.setItem("undo",JSON.stringify(c)),$("#undo").fadeIn(150),n=setTimeout(function(){return $("#undo").fadeOut(250),localStorage.removeItem("undo")},5e3),b=d(),b.splice(a,1),k(b)},h=function(){return k([])},f=function(a){var b,c,d,e;for(b=[],d=0,e=a.length;e>d;d++)c=a[d],b.push(c.name);return b},c=function(a){var b,c,d,e,f;for(b=[],c=e=0,f=a.length;f>e;c=++e)d=a[c],b[c]='<li><label><input type="checkbox" id="task'+c+'" />'+d.name+'</label><a class="priority" priority="'+d.priority+'">'+d.priority+"</a></li>";return b},m=function(a){var b;return b=c(a),$("#task-list").html(b)},o=function(){var a,b,c;return c=localStorage.getItem("undo"),c=JSON.parse(c),a=d(),b=c.position,delete c.position,a.splice(b,0,c),k(a),localStorage.removeItem("undo"),p(a)},p=function(a){return m(a),clearTimeout(n),$("#undo").hide()},g(),$("#task-submit").click(function(a){return a.preventDefault(),l()}),$("#mark-all-done").click(function(a){return a.preventDefault(),confirm("Are you sure you want to mark all tasks as done?")?h():void 0}),$("#undo").click(function(){return o()}),$(document).on("click","#task-list li label input",function(){var a;return a=$(this).closest("li"),$(a).fadeOut(500,function(){return i(e(a))})}),$(document).on("click",".priority",function(){var a,b,c,d;return d=$(this),b=d.attr("priority"),a=$.inArray(b,j),a===j.length-1&&(a=-1),b=j[a+1],c=$(this).closest("li"),q(c,"priority",b)})})}).call(this);